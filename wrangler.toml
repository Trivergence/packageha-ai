name = "packageha-ai"
main = "src/index.ts"
compatibility_date = "2024-12-16"

[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true

[vars]
# The Hybrid Sovereign Switch Configuration
# Options: "COMMERCIAL" | "COMMERCIAL_OPENAI" | "COMMERCIAL_GEMINI" | "SOVEREIGN" | "AIR_GAPPED"
SOVEREIGN_MODE = "COMMERCIAL_GEMINI" # Recommended: Gemini Flash 1.5 (fast, cost-effective, excellent JSON)

# AI Provider API Keys (get from secrets: wrangler secret put OPENAI_API_KEY)
# OPENAI_API_KEY = "sk-..." # Required for COMMERCIAL_OPENAI mode
# GEMINI_API_KEY = "..." # Required for COMMERCIAL_GEMINI mode (get from https://aistudio.google.com/app/apikey)

# Legacy Mode A (COMMERCIAL) - Cloudflare AI (small models, free but limited)
# SOVEREIGN_MODE = "COMMERCIAL"

# Mode A1 (COMMERCIAL_OPENAI) - OpenAI ChatGPT (GPT-4o-mini or gpt-4o)
# SOVEREIGN_MODE = "COMMERCIAL_OPENAI"
# Recommended model: gpt-4o-mini (cost-effective) or gpt-4o (best quality)

# Mode A2 (COMMERCIAL_GEMINI) - Google Gemini (Recommended for MVP)
# SOVEREIGN_MODE = "COMMERCIAL_GEMINI"
# Recommended model: gemini-1.5-flash (fast, cost-effective, excellent JSON generation)

# Mode B (SOVEREIGN) - Uncomment and configure for Vertex AI (Dammam Region)
# SOVEREIGN_MODE = "SOVEREIGN"
# VERTEX_AI_ENDPOINT = "https://aiplatform.googleapis.com/v1"
# VERTEX_AI_PROJECT = "your-gcp-project-id"
# VERTEX_AI_LOCATION = "asia-southeast1" # Dammam region

# Mode C (AIR_GAPPED) - Uncomment for local Llama server
# SOVEREIGN_MODE = "AIR_GAPPED"
# LOCAL_LLAMA_ENDPOINT = "http://localhost:8080/v1/chat/completions"



# 1. NEW: Enable Cloudflare AI
[ai]
binding = "AI"

[durable_objects]
bindings = [
  { name = "PackagehaSession", class_name = "PackagehaSession" }
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["PackagehaSession"]